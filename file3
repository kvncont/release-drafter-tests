Code for release draft 2
New code